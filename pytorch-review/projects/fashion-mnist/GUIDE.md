# FashionMNIST 项目学习指南

## 📋 项目概览

这是一个完整的图像分类项目，你将亲手编写每一行代码。我会作为你的导师，指导你完成每个步骤。

---

## 🎯 第1步：数据加载模块（data_loader.py）

### 任务目标
创建一个模块来加载和预处理 FashionMNIST 数据集。

### 需要实现的功能

#### 1.1 导入必要的库
你需要导入：
- `torch` 和 `torch.nn`
- `torchvision.datasets` 和 `torchvision.transforms`
- `torch.utils.data.DataLoader`

#### 1.2 定义数据变换
创建一个变换流程：
- 将图像转换为张量（ToTensor）
- 标准化图像（Normalize，均值=0.5，标准差=0.5）

#### 1.3 加载数据集
使用 `torchvision.datasets.FashionMNIST` 加载：
- 训练集：`train=True`
- 测试集：`train=False`
- 自动下载：`download=True`
- 应用变换：`transform=...`

#### 1.4 创建 DataLoader
为训练集和测试集创建 DataLoader：
- 批量大小（batch_size）：64
- 训练集打乱（shuffle）：True
- 测试集打乱：False

#### 1.5 数据可视化（可选）
编写一个函数来显示一批图像和标签。

### 提示
- 数据会自动下载到 `./data` 目录
- 图像原始值范围是 [0, 1]
- 标准化后范围变为 [-1, 1]

### 验收标准
- ✅ 能成功加载训练集和测试集
- ✅ DataLoader 可以正常迭代
- ✅ 打印出数据集大小和批次形状

---

## 🎯 第2步：模型定义（model.py）

### 任务目标
设计一个简单但有效的神经网络来分类图像。

### 需要实现的功能

#### 2.1 定义模型类
创建一个继承自 `nn.Module` 的类，命名为 `FashionMNISTNet`。

#### 2.2 设计网络架构
推荐的简单架构：
```
输入层：28×28 = 784 个像素
    ↓
全连接层1：784 → 512
    ↓
ReLU 激活
    ↓
全连接层2：512 → 256
    ↓
ReLU 激活
    ↓
全连接层3：256 → 10（10个类别）
```

#### 2.3 实现前向传播
在 `forward()` 方法中：
1. 将输入展平：`x.view(-1, 28*28)`    
2. 通过各层传播
3. 返回输出（不需要 Softmax，CrossEntropyLoss 会自动处理）

### 提示
- 使用 `nn.Linear()` 定义全连接层
- 使用 `torch.relu()` 或 `nn.ReLU()` 作为激活函数
- 输入形状：`(batch_size, 1, 28, 28)`
- 输出形状：`(batch_size, 10)`

### 验收标准
- ✅ 模型可以成功实例化
- ✅ 能够处理一个批次的数据
- ✅ 输出形状正确：`(batch_size, 10)`
- ✅ 可以打印模型结构和参数数量

---

## 🎯 第3步：训练脚本（train.py）

### 任务目标
实现完整的训练循环，训练模型并保存检查点。

### 需要实现的功能

#### 3.1 导入模块
导入你之前写的 `data_loader` 和 `model` 模块。

#### 3.2 设置超参数
定义：
- 学习率（learning_rate）：0.001
- 训练轮数（num_epochs）：10
- 设备（device）：'cuda' 如果可用，否则 'cpu'

#### 3.3 初始化组件
- 创建模型实例并移到设备上
- 定义损失函数：`nn.CrossEntropyLoss()`
- 定义优化器：`torch.optim.Adam()`

#### 3.4 实现训练循环
对每个 epoch：
1. 设置模型为训练模式：`model.train()`
2. 遍历训练数据：
   - 将数据移到设备
   - 清零梯度
   - 前向传播
   - 计算损失
   - 反向传播
   - 更新参数
3. 打印训练进度

#### 3.5 保存模型
训练完成后保存：
- 模型参数（state_dict）
- 完整检查点（包含 epoch、损失等）

### 提示
- 使用 `data.to(device)` 将数据移到 GPU/CPU
- 每个 epoch 结束后打印平均损失
- 创建 `checkpoints/` 目录保存模型

### 验收标准
- ✅ 训练循环正常运行
- ✅ 损失逐渐下降
- ✅ 模型成功保存到文件
- ✅ 打印训练进度信息

---

## 🎯 第4步：评估脚本（evaluate.py）

### 任务目标
在测试集上评估模型性能，计算准确率。

### 需要实现的功能

#### 4.1 加载训练好的模型
- 创建模型实例
- 加载保存的参数
- 设置为评估模式：`model.eval()`

#### 4.2 实现评估循环
使用 `torch.no_grad()`：
1. 遍历测试数据
2. 前向传播获取预测
3. 计算准确率

#### 4.3 计算指标
- 总体准确率
- 每个类别的准确率（可选）

#### 4.4 可视化结果（可选）
显示一些预测结果和真实标签。

### 提示
- 使用 `torch.max()` 获取预测类别
- 准确率 = 正确预测数 / 总样本数
- 不需要计算梯度，使用 `torch.no_grad()`

### 验收标准
- ✅ 成功加载模型
- ✅ 计算出测试集准确率
- ✅ 准确率在 80-85% 左右
- ✅ 打印详细的评估结果

---

## 🎯 第5步：预测脚本（predict.py）

### 任务目标
对单张图像进行预测，展示模型的实际应用。

### 需要实现的功能

#### 5.1 加载模型
加载训练好的模型。

#### 5.2 预测函数
实现一个函数：
- 输入：一张图像
- 输出：预测的类别和概率

#### 5.3 测试预测
从测试集中随机选择几张图像进行预测。

#### 5.4 显示结果
打印或可视化：
- 图像
- 预测类别
- 真实类别
- 预测概率

### 提示
- 单张图像需要添加 batch 维度：`image.unsqueeze(0)`
- 使用 `torch.softmax()` 将输出转换为概率
- 类别名称列表：['T恤', '裤子', '套衫', ...]

### 验收标准
- ✅ 能对单张图像进行预测
- ✅ 显示预测结果和真实标签
- ✅ 预测结果合理

---

## 📊 项目完成检查清单

完成所有步骤后，确保：

- [ ] `data_loader.py` - 数据加载正常
- [ ] `model.py` - 模型定义正确
- [ ] `train.py` - 训练成功完成
- [ ] `evaluate.py` - 测试准确率 > 80%
- [ ] `predict.py` - 预测功能正常
- [ ] `checkpoints/` - 模型已保存

---

## 🚀 开始编码

现在你可以开始了！从第1步开始，创建 `data_loader.py` 文件。

**记住**：
- 遇到问题随时问我
- 每完成一步就运行测试
- 不要着急，一步一步来

祝你编码愉快！🎉
